DREAMS_Districts_Botswana <- c("Bobirwa District", 
                               "Mahalapye District", 
                               "Serowe District",
                               "Kgatleng District", 
                               "Kweneng East District", 
                               "North East District", 
                               "Gaborone District", 
                               "Southern District")

DREAMS_Districts_Botswana_USCB <- c("BOBONONG",
                                    "MAHALAPYE", 
                                    "SEROWE PALAPYE",
                                    "KGATLENG", 
                                    "KWENENG EAST", 
                                    "NORTH EAST", 
                                    "GABORONE", 
                                    "SOUTHERN")

DREAMS_Districts_CotedIvoire <- c("Abobo-Est", 
                                  "Cocody-Bingerville",
                                  "Daloa",
                                  "Man")

DREAMS_Districts_Eswatini <- c("Hhohho", 
                               "Lubombo",
                               "Manzini",
                               "Shiselweni")

DREAMS_Districts_Haiti <- c("Dessalines",
                            "Saint-Marc",
                            "Cap-Haïtien",
                            "Port-au-Prince")

DREAMS_Districts_Kenya <- c("Homa Bay County", 
                            "Kiambu County", 
                            "Kisumu County", 
                            "Migori County", 
                            "Mombasa County", 
                            "Nairobi County", 
                            "Siaya County")

DREAMS_Districts_Kenya_USCB <- c("HOMA BAY",
                                 "KIAMBU", 
                                 "KISUMU", 
                                 "MIGORI", 
                                 "MOMBASA", 
                                 "NAIROBI CITY", 
                                 "SIAYA")

DREAMS_Districts_Lesotho <- c("Berea", 
                              "Mafeteng",
                              "Maseru",
                              "Mohale's Hoek")

DREAMS_Districts_Lesotho_USCB <- c("BEREA", 
                                   "MAFETENG",
                                   "MASERU",
                                   "MOHALE'S HOEK")

DREAMS_Districts_Malawi <- c("Blantyre District", 
                              "Machinga District",
                              "Zomba District")

DREAMS_Districts_Malawi_USCB <- c("BLANTYRE", 
                                  "MACHINGA",
                                  "ZOMBA")

DREAMS_Districts_Mozambique <- c("Pemba",
                                 "Chokwe",
                                 "Chonguene",
                                 "Guija",
                                 "Limpopo",
                                 "Xai-Xai",
                                 "Maxixe",
                                 "Chimoio",
                                 "Boane",
                                 "Magude",
                                 "Manhiça",
                                 "Marracuene",
                                 "Matola",
                                 "Matutuine",
                                 "Moamba",
                                 "Namaacha",
                                 "Erati",
                                 "Nampula",
                                 "Beira",
                                 "Caia",
                                 "Gile",
                                 "Ile",
                                 "Inhassunge",
                                 "Lugela",
                                 "Maganja Da Costa",
                                 "Milange",
                                 "Mocuba",
                                 "Mocubela",
                                 "Namacurra",
                                 "Nicoadala",
                                 "Pebane",
                                 "Quelimane")

DREAMS_Districts_Mozambique_USCB <- c("CIDADE DE PEMBA",
                                      "CHÓKWÈ",
                                      "CHONGOENE",
                                      "GUIJÁ",
                                      "LIMPOPO",
                                      "CIDADE DE XAI-XAI",
                                      "CIDADE DA MAXIXE",
                                      "CIDADE DE CHIMOIO",
                                      "BOANE",
                                      "MAGUDE",
                                      "MANHIÇA",
                                      "MARRACUENE",
                                      "CIDADE DA MATOLA",
                                      "MATUTUINE",
                                      "MOAMBA",
                                      "NAMAACHA",
                                      "ERÁTI",
                                      "CIDADE DE NAMPULA",
                                      "CIDADE DA BEIRA",
                                      "CAIA",
                                      "GILÉ",
                                      "ILE",
                                      "INHASSUNGE",
                                      "LUGELA",
                                      "MAGANJA DA COSTA",
                                      "MILANGE",
                                      "MOCUBA",
                                      "MOCUBELA",
                                      "NAMACURRA",
                                      "NICOADALA",
                                      "PEBANE",
                                      "QUELIMANE")

DREAMS_Districts_Namibia <- c("Andara",
                              "Nyangana",
                              "Rundu",
                              "Windhoek",
                              "Oshakati",
                              "Omuthiya",
                              "Onandjokwe",
                              "Tsumeb",
                              "Katima Mulilo")
                                   
DREAMS_Districts_Namibia_USCB <- c("MUKWE", 
                                   "NDIYONA",
                                   "RUNDU",
                                   "WINDHOEK",
                                   "OSHAKATI",
                                   "OMUTHIYAGWIIPUNDI",
                                   "ONIIPA",
                                   "TSUMEB",
                                   "KATIMA MULILO")

DREAMS_Districts_Rwanda <- c("East",
                             "Kigali City",
                             "South")

DREAMS_Districts_Rwanda_USCB <- c("EASTERN PROVINCE", 
                                  "KIGALI",
                                  "SOUTHERN PROVINCE")

DREAMS_Districts_SouthAfrica <- c("ec Alfred Nzo District Municipality",
                                  "nw Bojanala Platinum District Municipality",
                                  "ec Buffalo City Metropolitan Municipality",
                                  "lp Capricorn District Municipality",
                                  "wc City of Cape Town Metropolitan Municipality",
                                  "gp City of Johannesburg Metropolitan Municipality",
                                  "gp City of Tshwane Metropolitan Municipality",
                                  "nw Dr Kenneth Kaunda District Municipality",
                                  "mp Ehlanzeni District Municipality",
                                  "gp Ekurhuleni Metropolitan Municipality",
                                  "kz eThekwini Metropolitan Municipality",
                                  "mp Gert Sibande District Municipality",
                                  "fs Lejweleputswa District Municipality",
                                  "lp Mopani District Municipality",
                                  "nw Ngaka Modiri Molema District Municipality",
                                  "mp Nkangala District Municipality",
                                  "ec Oliver Tambo District Municipality",
                                  "gp Sedibeng District Municipality",
                                  "fs Thabo Mofutsanyane District Municipality",
                                  "kz Ugu District Municipality",
                                  "kz uMgungundlovu District Municipality",
                                  "kz Uthukela District Municipality",
                                  "kz King Cetshwayo District Municipality",
                                  "kz Zululand District Municipality")

DREAMS_Districts_SouthAfrica_USCB <- c("ALFRED NZO",
                                       "BOJANALA",
                                       "BUFFALO CITY",
                                       "CAPRICORN",
                                       "CITY OF CAPE TOWN",
                                       "CITY OF JOHANNESBURG",
                                       "CITY OF TSHWANE",
                                       "DOCTOR KENNETH KAUNDA",
                                       "EHLANZENI",
                                       "EKURHULENI",
                                       "ETHEKWINI",
                                       "GERT SIBANDE",
                                       "LEJWELEPUTSWA",
                                       "MOPANI",
                                       "NGAKA MODIRI MOLEMA",
                                       "NKANGALA",
                                       "O.R. TAMBO",
                                       "SEDIBENG",
                                       "THABO MOFUTSANYANE",
                                       "UGU",
                                       "UMGUNGUNDLOVU",
                                       "UTHUKELA",
                                       "UTHUNGULU",
                                       "ZULULAND")

DREAMS_Districts_Tanzania <- c("Kahama TC",
                               "Kyela DC",
                               "Mbarali DC",
                               "Mbeya City Council",
                               "Msalala DC",
                               "Mufindi DC",
                               "Muleba DC",
                               "Nyamagana MC",
                               "Shinyanga DC",
                               "Shinyanga MC",
                               "Temeke MC",
                               "Ushetu DC")

DREAMS_Districts_Uganda <- c("Bukomansimbi District",
                                  "Gomba District",
                                  "Kalangala District",
                                  "Kyotera District",
                                  "Lwengo District",
                                  "Lyantonde District",
                                  "Masaka District",
                                  "Rakai District",
                                  "Sembabule District",
                                  "Wakiso District",
                                  "Kassanda District",
                                  "Luwero District",
                                  "Mityana District",
                                  "Mubende District",
                                  "Mukono District",
                                  "Kampala District",
                                  "Agago District",
                                  "Apac District",
                                  "Gulu District",
                                  "Kwania District",
                                  "Lira District",
                                  "Omoro District",
                                  "Oyam District",
                                  "Mbarara District")

DREAMS_Districts_Uganda_USCB <- c("BUKOMANSIMBI",
                                  "GOMBA",
                                  "KALANGALA",
                                  "KYOTERA",
                                  "LWENGO",
                                  "LYANTONDE",
                                  "MASAKA",
                                  "RAKAI",
                                  "SEMBABULE",
                                  "WAKISO",
                                  "KASANDA",
                                  "LUWERO",
                                  "MITYANA",
                                  "MUBENDE",
                                  "MUKONO",
                                  "KAMPALA",
                                  "AGAGO",
                                  "APAC",
                                  "GULU",
                                  "KWANIA",
                                  "LIRA",
                                  "OMORO",
                                  "OYAM",
                                  "MBARARA")

DREAMS_Districts_Zambia <- c("Chingola District",
                                  "Chipata District",
                                  "Kabwe District", 
                                  "Kapiri-Mposhi District",
                                  "Kasama District",
                                  "Kitwe District",
                                  "Livingstone District",
                                  "Luanshya District",
                                  "Lusaka District",
                                  "Mazabuka District",
                                  "Monze District",
                                  "Mongu District",
                                  "Mufulira District",
                                  "Ndola District")

DREAMS_Districts_Zambia_USCB <- c("CHINGOLA",
                                  "CHIPATA",
                                  "KABWE", 
                                  "KAPIRI MPOSHI",
                                  "KASAMA",
                                  "KITWE",
                                  "LIVINGSTONE",
                                  "LUANSHYA",
                                  "LUSAKA",
                                  "MAZABUKA",
                                  "MONZE",
                                  "MONGU",
                                  "MUFULIRA",
                                  "NDOLA")

DREAMS_Districts_Zimbabwe <- c("Beitbridge",
                                "Bubi",
                                "Bulawayo",
                                "Bulilima",
                                "Chipinge",
                                "Gwanda",
                                "Gweru",
                                "Insiza",
                                "Lupane",
                                "Makoni",
                                "Mangwe",
                                "Matobo",
                                "Mazowe",
                                "Mutare",
                                "Nkayi",
                                "Tsholotsho")

DREAMS_Districts_Zimbabwe_USCB <- c("BEITBRIDGE",
                                    "BUBI",
                                    "BULAWAYO",
                                    "BULILIMA",
                                    "CHIPINGE",
                                    "GWANDA",
                                    "GWERU",
                                    "INSIZA",
                                    "LUPANE",
                                    "MAKONI",
                                    "MANGWE",
                                    "MATOBO",
                                    "MAZOWE",
                                    "MUTARE",
                                    "NKAYI",
                                    "TSHOLOTSHO")

countryData <- readRDS("data/countryData.RDS")

AGYW_PREV <- s3read_using(FUN = read.csv,
             bucket = Sys.getenv("TEST_BUCKET_WRITE"),
             object = "system_dreams_saturation/AGYW_PREVbyCountry.csv") %>%
  as.data.frame()

countryDataJoined <- left_join(countryData,
                               AGYW_PREV,
                               by = c("JOIN_NAME" = "JOIN_NAME", 
                                      "fiscal_year" = "fiscal_year", 
                                      "country" = "country", 
                                      "ageasentered" = "ageasentered")) %>%
  dplyr::select(-c("snu1",
            "psnu",
            "X")) %>%
  mutate(
    AGYW_PREV = case_when(
      (is.na(AGYW_PREV)) ~ as.numeric(0),
      TRUE ~ as.numeric(AGYW_PREV)
    )) %>%
  mutate(
    AREA_NAME = case_when(
      (JOIN_NAME == "BOBONONG" & country == "Botswana") ~ "Bobirwa District",
      (JOIN_NAME == "MAHALAPYE" & country == "Botswana") ~ "Mahalapye District",
      (JOIN_NAME == "SEROWE PALAPYE" & country == "Botswana") ~ "Serowe District",
      (JOIN_NAME == "KGATLENG" & country == "Botswana") ~ "Kgatleng District",
      (JOIN_NAME == "KWENENG EAST" & country == "Botswana") ~ "Kweneng East District",
      (JOIN_NAME == "NORTH EAST" & country == "Botswana") ~ "North East District",
      (JOIN_NAME == "GABORONE" & country == "Botswana") ~ "Gaborone District",
      (JOIN_NAME == "SOUTHERN" & country == "Botswana") ~ "Southern District",
      (JOIN_NAME == "Abobo-Est" & country == "Cote d'Ivoire") ~ "Abobo-Est",
      (JOIN_NAME == "Cocody-Bingerville" & country == "Cote d'Ivoire") ~ "Cocody-Bingerville",
      (JOIN_NAME == "Daloa" & country == "Cote d'Ivoire") ~ "Daloa",
      (JOIN_NAME == "Man" & country == "Cote d'Ivoire") ~ "Man",
      (JOIN_NAME == "Dessalines" & country == "Haiti") ~ "Dessalines",
      (JOIN_NAME == "Saint-Marc" & country == "Haiti") ~ "Saint-Marc",
      (JOIN_NAME == "Cap-Haïtien" & country == "Haiti") ~ "Cap-Haïtien",
      (JOIN_NAME == "Port-au-Prince" & country == "Haiti") ~ "Port-au-Prince",
      (JOIN_NAME == "BLANTYRE" & country == "Malawi") ~ "Blantyre District", #JOIN_NAME for Malawi
      (JOIN_NAME == "MACHINGA" & country == "Malawi") ~ "Machinga District", #JOIN_NAME for Malawi
      (JOIN_NAME == "ZOMBA" & country == "Malawi") ~ "Zomba District", #JOIN_NAME for Malawi
      (JOIN_NAME == "CIDADE DE PEMBA" & country == "Mozambique") ~ "Pemba",
      (JOIN_NAME == "CHÓKWÈ" & country == "Mozambique") ~ "Chokwe",
      (JOIN_NAME == "CHONGOENE" & country == "Mozambique") ~ "Chonguene",
      (JOIN_NAME == "GUIJÁ" & country == "Mozambique") ~ "Guija",
      (JOIN_NAME == "LIMPOPO" & country == "Mozambique") ~ "Limpopo",
      (JOIN_NAME == "CIDADE DE XAI-XAI" & country == "Mozambique") ~ "Xai-Xai",
      (JOIN_NAME == "CIDADE DA MAXIXE" & country == "Mozambique") ~ "Maxixe",
      (JOIN_NAME == "CIDADE DE CHIMOIO" & country == "Mozambique") ~ "Chimoio",
      (JOIN_NAME == "BOANE" & country == "Mozambique") ~ "Boane",
      (JOIN_NAME == "MAGUDE" & country == "Mozambique") ~ "Magude",
      (JOIN_NAME == "MANHIÇA" & country == "Mozambique") ~ "Manhiça",
      (JOIN_NAME == "MARRACUENE" & country == "Mozambique") ~ "Marracuene",
      (JOIN_NAME == "CIDADE DA MATOLA" & country == "Mozambique") ~ "Matola",
      (JOIN_NAME == "MATUTUINE" & country == "Mozambique") ~ "Matutuine",
      (JOIN_NAME == "MOAMBA" & country == "Mozambique") ~ "Moamba",
      (JOIN_NAME == "NAMAACHA" & country == "Mozambique") ~ "Namaacha",
      (JOIN_NAME == "ERÁTI" & country == "Mozambique") ~ "Erati",
      (JOIN_NAME == "CIDADE DE NAMPULA" & country == "Mozambique") ~ "Nampula",
      (JOIN_NAME == "CIDADE DA BEIRA" & country == "Mozambique") ~ "Beira",
      (JOIN_NAME == "CAIA" & country == "Mozambique") ~ "Caia",
      (JOIN_NAME == "GILÉ" & country == "Mozambique") ~ "Gile",
      (JOIN_NAME == "ILE" & country == "Mozambique") ~ "Ile",
      (JOIN_NAME == "INHASSUNGE" & country == "Mozambique") ~ "Inhassunge",
      (JOIN_NAME == "LUGELA" & country == "Mozambique") ~ "Lugela",
      (JOIN_NAME == "MAGANJA DA COSTA" & country == "Mozambique") ~ "Maganja Da Costa",
      (JOIN_NAME == "MILANGE" & country == "Mozambique") ~ "Milange",
      (JOIN_NAME == "MOCUBA" & country == "Mozambique") ~ "Mocuba",
      (JOIN_NAME == "MOCUBELA" & country == "Mozambique") ~ "Mocubela",
      (JOIN_NAME == "NAMACURRA" & country == "Mozambique") ~ "Namacurra",
      (JOIN_NAME == "NICOADALA" & country == "Mozambique") ~ "Nicoadala",
      (JOIN_NAME == "PEBANE" & country == "Mozambique") ~ "Pebane",
      (JOIN_NAME == "QUELIMANE" & country == "Mozambique") ~ "Quelimane",
      (JOIN_NAME == "MUKWE" & country == "Namibia") ~ "Andara",
      (JOIN_NAME == "NDIYONA" & country == "Namibia") ~ "Nyangana",
      (JOIN_NAME == "RUNDU" & country == "Namibia") ~ "Rundu",
      (JOIN_NAME == "WINDHOEK" & country == "Namibia") ~ "Windhoek",
      (JOIN_NAME == "OSHAKATI" & country == "Namibia") ~ "Oshakati",
      (JOIN_NAME == "OMUTHIYAGWIIPUNDI" & country == "Namibia") ~ "Omuthiya",
      (JOIN_NAME == "ONIIPA" & country == "Namibia") ~ "Onandjokwe",
      (JOIN_NAME == "TSUMEB" & country == "Namibia") ~ "Tsumeb",
      (JOIN_NAME == "KATIMA MULILO" & country == "Namibia") ~ "Katima Mulilo",
      (JOIN_NAME == "ALFRED NZO" & country == "South Africa") ~ "ec Alfred Nzo District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "BOJANALA" & country == "South Africa") ~ "nw Bojanala Platinum District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "BUFFALO CITY" & country == "South Africa") ~ "ec Buffalo City Metropolitan Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "CAPRICORN" & country == "South Africa") ~ "lp Capricorn District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "CITY OF CAPE TOWN" & country == "South Africa") ~ "wc City of Cape Town Metropolitan Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "CITY OF JOHANNESBURG" & country == "South Africa") ~ "gp City of Johannesburg Metropolitan Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "CITY OF TSHWANE" & country == "South Africa") ~ "gp City of Tshwane Metropolitan Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "DOCTOR KENNETH KAUNDA" & country == "South Africa") ~ "nw Dr Kenneth Kaunda District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "EHLANZENI" & country == "South Africa") ~ "mp Ehlanzeni District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "EKURHULENI" & country == "South Africa") ~ "gp Ekurhuleni Metropolitan Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "ETHEKWINI" & country == "South Africa") ~ "kz eThekwini Metropolitan Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "GERT SIBANDE" & country == "South Africa") ~ "mp Gert Sibande District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "LEJWELEPUTSWA" & country == "South Africa") ~ "fs Lejweleputswa District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "MOPANI" & country == "South Africa") ~ "lp Mopani District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "NGAKA MODIRI MOLEMA" & country == "South Africa") ~ "nw Ngaka Modiri Molema District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "NKANGALA" & country == "South Africa") ~ "mp Nkangala District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "OR TAMBO" & country == "South Africa") ~ "ec Oliver Tambo District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "SEDIBENG" & country == "South Africa") ~ "gp Sedibeng District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "THABO MOFUTSANYANE" & country == "South Africa") ~ "fs Thabo Mofutsanyane District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "UGU" & country == "South Africa") ~ "kz Ugu District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "UMGUNGUNDLOVU" & country == "South Africa") ~ "kz uMgungundlovu District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "UTHUKELA" & country == "South Africa") ~ "kz Uthukela District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "UTHUNGULU" & country == "South Africa") ~ "kz King Cetshwayo District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "ZULULAND" & country == "South Africa") ~ "kz Zululand District Municipality", #JOIN_NAME for South Africa
      (JOIN_NAME == "TEMEKE MUNICIPAL COUNCIL" & country == "Tanzania") ~ "Temeke MC",
      (JOIN_NAME == "MUFINDI DISTRICT COUNCIL" & country == "Tanzania") ~ "Mufindi DC",
      (JOIN_NAME == "MULEBA DISTRIC COUNCIL" & country == "Tanzania") ~ "Muleba DC",
      (JOIN_NAME == "KYELA DISTRICT COUNCIL" & country == "Tanzania") ~ "Kyela DC",
      (JOIN_NAME == "MBARALI DISTRICT COUNCIL" & country == "Tanzania") ~ "Mbarali DC",
      (JOIN_NAME == "MBEYA CITY COUNCIL" & country == "Tanzania") ~ "Mbeya CC",
      (JOIN_NAME == "NYAMAGANA MUNICIPAL COUNCIL" & country == "Tanzania") ~ "Nyamagana MC",
      (JOIN_NAME == "KAHAMA TOWN COUNCIL" & country == "Tanzania") ~ "Kahama TC",
      (JOIN_NAME == "MSALALA" & country == "Tanzania") ~ "Msalala DC",
      (JOIN_NAME == "SHINYANGA DISTRICT COUNCIL" & country == "Tanzania") ~ "Shinyanga DC",
      (JOIN_NAME == "SHINYANGA MUNICIPAL COUNCIL" & country == "Tanzania") ~ "Shinyanga MC",
      (JOIN_NAME == "USHETU DISTRICT COUNCIL" & country == "Tanzania") ~ "Ushetu DC",
      (JOIN_NAME == "BUKOMANSIMBI" & country == "Uganda") ~ "Bukomansimbi District",
      (JOIN_NAME == "GOMBA" & country == "Uganda") ~ "Gomba District",
      (JOIN_NAME == "KALANGALA" & country == "Uganda") ~ "Kalangala District",
      (JOIN_NAME == "KYOTERA" & country == "Uganda") ~ "Kyotera District",
      (JOIN_NAME == "LWENGO" & country == "Uganda") ~ "Lwengo District",
      (JOIN_NAME == "LYANTONDE" & country == "Uganda") ~ "Lyantonde District",
      (JOIN_NAME == "MASAKA" & country == "Uganda") ~ "Masaka District",
      (JOIN_NAME == "RAKAI" & country == "Uganda") ~ "Rakai District",
      (JOIN_NAME == "SEMBABULE" & country == "Uganda") ~ "Sembabule District",
      (JOIN_NAME == "WAKISO" & country == "Uganda") ~ "Wakiso District",
      (JOIN_NAME == "KASANDA" & country == "Uganda") ~ "Kassanda District",
      (JOIN_NAME == "LUWERO" & country == "Uganda") ~ "Luwero District",
      (JOIN_NAME == "MITYANA" & country == "Uganda") ~ "Mityana District",
      (JOIN_NAME == "MUBENDE" & country == "Uganda") ~ "Mubende District",
      (JOIN_NAME == "MUKONO" & country == "Uganda") ~ "Mukono District",
      (JOIN_NAME == "KAMPALA" & country == "Uganda") ~ "Kampala District",
      (JOIN_NAME == "AGAGO" & country == "Uganda") ~ "Agago District",
      (JOIN_NAME == "APAC" & country == "Uganda") ~ "Apac District",
      (JOIN_NAME == "GULU" & country == "Uganda") ~ "Gulu District",
      (JOIN_NAME == "KWANIA" & country == "Uganda") ~ "Kwania District",
      (JOIN_NAME == "LIRA" & country == "Uganda") ~ "Lira District",
      (JOIN_NAME == "OMORO" & country == "Uganda") ~ "Omoro District",
      (JOIN_NAME == "OYAM" & country == "Uganda") ~ "Oyam District",
      (JOIN_NAME == "MBARARA" & country == "Uganda") ~ "Mbarara District",
      (JOIN_NAME == "KABWE" & country == "Zambia") ~ "Kabwe District",
      (JOIN_NAME == "KAPIRI MPOSHI" & country == "Zambia") ~ "Kapiri-Mposhi District",
      (JOIN_NAME == "CHINGOLA" & country == "Zambia") ~ "Chingola District",
      (JOIN_NAME == "KITWE" & country == "Zambia") ~ "Kitwe District",
      (JOIN_NAME == "LUANSHYA" & country == "Zambia") ~ "Luanshya District",
      (JOIN_NAME == "MUFULIRA" & country == "Zambia") ~ "Mufulira District",
      (JOIN_NAME == "NDOLA" & country == "Zambia") ~ "Ndola District",
      (JOIN_NAME == "CHIPATA" & country == "Zambia") ~ "Chipata District",
      (JOIN_NAME == "LUSAKA" & country == "Zambia") ~ "Lusaka District",
      (JOIN_NAME == "KASAMA" & country == "Zambia") ~ "Kasama District",
      (JOIN_NAME == "LIVINGSTONE" & country == "Zambia") ~ "Livingstone District",
      (JOIN_NAME == "MAZABUKA" & country == "Zambia") ~ "Mazabuka District",
      (JOIN_NAME == "MONZE" & country == "Zambia") ~ "Monze District",
      (JOIN_NAME == "MONGU" & country == "Zambia") ~ "Mongu District",
      (JOIN_NAME == "BULAWAYO" & country == "Zimbabwe") ~ "Bulawayo",
      (JOIN_NAME == "CHIPINGE" & country == "Zimbabwe") ~ "Chipinge",
      (JOIN_NAME == "MAKONI" & country == "Zimbabwe") ~ "Makoni",
      (JOIN_NAME == "MUTARE" & country == "Zimbabwe") ~ "Mutare",
      (JOIN_NAME == "MAZOWE" & country == "Zimbabwe") ~ "Mazowe",
      (JOIN_NAME == "BUBI" & country == "Zimbabwe") ~ "Bubi",
      (JOIN_NAME == "LUPANE" & country == "Zimbabwe") ~ "Lupane",
      (JOIN_NAME == "NKAYI" & country == "Zimbabwe") ~ "Nkayi",
      (JOIN_NAME == "TSHOLOTSHO" & country == "Zimbabwe") ~ "Tsholotsho",
      (JOIN_NAME == "BEITBRIDGE" & country == "Zimbabwe") ~ "Beitbridge",
      (JOIN_NAME == "BULILIMA" & country == "Zimbabwe") ~ "Bulilima",
      (JOIN_NAME == "GWANDA" & country == "Zimbabwe") ~ "Gwanda",
      (JOIN_NAME == "INSIZA" & country == "Zimbabwe") ~ "Insiza",
      (JOIN_NAME == "MANGWE" & country == "Zimbabwe") ~ "Mangwe",
      (JOIN_NAME == "MATOBO" & country == "Zimbabwe") ~ "Matobo",
      (JOIN_NAME == "GWERU" & country == "Zimbabwe") ~ "Gweru",
      (JOIN_NAME == "Hhohho" & country == "Eswatini") ~ "Hhohho",
      (JOIN_NAME == "Lubombo" & country == "Eswatini") ~ "Lubombo",
      (JOIN_NAME == "Manzini" & country == "Eswatini") ~ "Manzini",
      (JOIN_NAME == "Shiselweni" & country == "Eswatini") ~ "Shiselweni",
      (JOIN_NAME == "HOMA BAY" & country == "Kenya") ~ "Homa Bay County",
      (JOIN_NAME == "KIAMBU" & country == "Kenya") ~ "Kiambu County",
      (JOIN_NAME == "KISUMU" & country == "Kenya") ~ "Kisumu County",
      (JOIN_NAME == "MIGORI" & country == "Kenya") ~ "Migori County",
      (JOIN_NAME == "MOMBASA" & country == "Kenya") ~ "Mombasa County",
      (JOIN_NAME == "NAIROBI CITY" & country == "Kenya") ~ "Nairobi County",
      (JOIN_NAME == "SIAYA" & country == "Kenya") ~ "Siaya County",
      (JOIN_NAME == "BEREA" & country == "Lesotho") ~ "Berea",
      (JOIN_NAME == "MAFETENG" & country == "Lesotho") ~ "Mafeteng",
      (JOIN_NAME == "MASERU" & country == "Lesotho") ~ "Maseru",
      (JOIN_NAME == "MOHALE'S HOEK" & country == "Lesotho") ~ "Mohale's Hoek",
      (JOIN_NAME == "EASTERN PROVINCE" & country == "Rwanda") ~ "East",
      (JOIN_NAME == "KIGALI" & country == "Rwanda") ~ "Kigali City",
      (JOIN_NAME == "SOUTHERN PROVINCE" & country == "Rwanda") ~ "South"
    )
  )

# botADM1.sf <- readRDS('data/BotswanaADM1.RDS') %>%
#   attachDREAMSField("Botswana")
botADM2.sf <- readRDS('data/BotswanaADM2.RDS') %>%
  attachDREAMSField("Botswana")
cdiADM2.sf <- readRDS('data/CDIADM2.RDS') %>%
  attachDREAMSField("CDI")
eswADM1.sf <- readRDS('data/EswADM1.RDS') %>%
  attachDREAMSField("Eswatini")
haiADM2.sf <- readRDS('data/HaiADM2.RDS') %>%
  attachDREAMSField("Haiti")
kenADM1.sf <- readRDS('data/KenyaADM1.RDS') %>%
  attachDREAMSField("Kenya")
lesADM1.sf <- readRDS('data/LesothoADM1.RDS') %>%
  attachDREAMSField("Lesotho")
malADM1.sf <- readRDS('data/MalawiADM1.RDS') %>%
  attachDREAMSField("Malawi")
mozADM2.sf <- readRDS('data/MozambiqueADM2.RDS') %>%
  attachDREAMSField("Mozambique")
namADM2.sf <- readRDS('data/NamibiaADM2.RDS') %>%
  attachDREAMSField("Namibia")
rwaADM1.sf <- readRDS('data/RwandaADM1.RDS') %>%
  attachDREAMSField("Rwanda")
safADM1.sf <- readRDS('data/SAfricaADM1.RDS') %>%
  attachDREAMSField("South Africa") %>%
  mutate(
    AREA_NAME = case_when(
      (AREA_NAME == "OR TAMBO") ~ "O.R. TAMBO",
      TRUE ~ as.character(AREA_NAME)
    )
  )
tanADM2.sf <- readRDS('data/TanzaniaADM2.RDS') %>%
  attachDREAMSField("Tanzania")
ugaADM1.sf <- readRDS('data/UgandaADM1.RDS') %>%
  attachDREAMSField("Uganda")
zamADM1.sf <- readRDS('data/ZambiaADM2.RDS') %>%
  attachDREAMSField("Zambia")
zimADM2.sf <- readRDS('data/ZimbabweADM2.RDS') %>%
  attachDREAMSField("Zimbabwe")

dataParameters_1Year <- dataParametersImportandMutate("www/defaultTemplate_1year.xlsx") %>%
  dataParametersPivot1Year()

dataParameters_5Year  <- dataParametersImportandMutate("www/defaultTemplate_5year.xlsx") %>%
  dataParametersPivot5Year()

SingleYearNatAGYWPops <- readRDS('data/SingleYearNationalAGYWPops.RDS')


small_countries <- c("Eswatini",
                     "Haiti",
                     "Lesotho",
                     "Rwanda")
medium_countries <- c("Malawi",
                      "Uganda",
                      "Zimbabwe")
large_countries <- c("Botswana",
                     "Cote d'Ivoire",
                     "Kenya", 
                     "Mozambique",
                     "Namibia",
                     "South Africa", 
                     "Tanzania",
                     "Zambia")

default1YearTemplate <- readxl::read_xlsx('www/defaultTemplate_1year.xlsx') 
default5YearTemplate <- readxl::read_xlsx('www/defaultTemplate_5year.xlsx') %>%
  mutate(
    AgeCohort = case_when(
      (AgeCohort == "10 to 14") ~ as.character("10-14"),
      (AgeCohort == "15 to 19") ~ as.character("15-19"),
      (AgeCohort == "20 to 24") ~ as.character("20-24"),
      (AgeCohort == "25 to 29") ~ as.character("25-29")
    )
  )

defaultData <- attachParameters_5year(countryDataJoined,
                                      dataParameters_5Year) %>%
  reshapeWide() %>%
  attachParameters_1year(dataParameters_1Year) %>%
  mergeAccountingForCDI(SingleYearNatAGYWPops) %>%
  deriveStatistics() 
  
defaultData$Pop_2018_Default <- defaultData$Pop_2018
defaultData$Pop_2019_Default <- defaultData$Pop_2019
defaultData$Pop_2020_Default <- defaultData$Pop_2020
defaultData$Pop_2021_Default <- defaultData$Pop_2021
defaultData$Pop_2022_Default <- defaultData$Pop_2022
defaultData$Pop_2023_Default <- defaultData$Pop_2023

defaultStats2022 <- defaultData %>%
  mutate(
    IsSelected = case_when(
      (PopStructure == "Default") ~ as.character("Selected"),
      TRUE ~ as.character("Unselected")
    )
  ) %>%
  reduceTo2022Export()

defaultStatsCOP <- defaultData %>%
  mutate(
    IsSelected = case_when(
      (PopStructure == "Default") ~ as.character("Selected"),
      TRUE ~ as.character("Unselected")
    )
  ) %>%
  reduceToCOPExport()
  
defaultData_trimmed <- defaultData %>%
  dplyr::filter(PopStructure == "Default") %>%
  dplyr::select(c("country",
                  "AREA_NAME",
                  "ageasentered",
                  "Pop_2018",
                  "Pop_2019",
                  "Pop_2020",
                  "Pop_2021",
                  "Pop_2022",
                  "Pop_2023")) 

default5YearTemplate <- left_join(default5YearTemplate,
                                  defaultData_trimmed,
                                  by = c("Country" = "country",
                                         "District" = "AREA_NAME",
                                         "AgeCohort" = "ageasentered"),
                                  keep = TRUE) %>%
  dplyr::select(-c("country",
                   "AREA_NAME",
                   "ageasentered"))

rm(defaultData_trimmed)

rm(countryData)
rm(countryDataJoined)
rm(AGYW_PREV)


